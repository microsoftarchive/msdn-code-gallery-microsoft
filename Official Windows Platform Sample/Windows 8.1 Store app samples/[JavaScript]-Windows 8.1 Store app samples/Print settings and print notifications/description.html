<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/a7d1e078-8570-47da-a87b-ff462dfc958dCombined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Print settings and print notifications</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Print settings and print notifications</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            XAML, HTML5, Windows Runtime
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Devices and sensors, Windows Store device app
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Windows RT
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">11/25/2013</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MS-LPL</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Device-app-for-printers-91f363a9">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<div id="mainSection">
<p>This sample shows how to create a Windows Store device app that can extend the print settings and printer notifications experience. This sample can be activated from the tile contract, the printTaskSettings contract, and from toast displayed by backgroundTask
 in response to print driver event. This sample also includes a printer extension library that can be used to access a printer from a Windows Store device app written for Windows&nbsp;8.1.
</p>
<p>Windows Store device apps for printers let printer manufacturers create a Windows Store app that serves as a companion to their device. A Windows Store device app includes a StoreManifest.xml file that specifies a device metadata experience ID. Device metadata
 associates a specific Windows Store app with a specific printer or family of printers. For more info, see
<a href="http://go.microsoft.com/fwlink/p/?LinkId=306682">Windows Store device apps for printers</a>.</p>
<p>To obtain an evaluation copy of Windows&nbsp;8.1, go to <a href="http://go.microsoft.com/fwlink/p/?linkid=301696">
Windows&nbsp;8.1</a>.</p>
<p>To obtain an evaluation copy of Microsoft Visual Studio&nbsp;2013, go to <a href="http://go.microsoft.com/fwlink/p/?linkid=301697">
Visual Studio&nbsp;2013</a>.</p>
<p></p>
<p class="note"><b>Note</b>&nbsp;&nbsp;For Windows&nbsp;8 app samples, download the <a href="http://go.microsoft.com/fwlink/p/?LinkId=301698">
Windows&nbsp;8 app samples pack</a>. The samples in the Windows&nbsp;8 app samples pack will build and run only on Microsoft Visual Studio&nbsp;2012.</p>
<p></p>
<p><b>Printer Extension Library</b></p>
<p>The JavaScript sample uses a C# printer extension library to perform print-specific tasks that are unavailable to JavaScript in the runtime. The printer extension library references a standard .NET library that provides interop functionality with the COM-based
 printing infrastructure. The C# sample uses the same printer extension library to follow the same logical structure and allow for code sharing between samples.</p>
<p>The Visual Studio project PrinterExtensionLibrary wraps the COM implementation of the COM interface PrinterExtensionLib. This enables code sharing between printer extensions and Windows Store device apps for printers. You should consider adding any helper
 objects, convenience methods, or data model code at this layer. For more info about these interfaces, see
<a href="http://go.microsoft.com/fwlink/p/?LinkID=299887">Printer Extension Interfaces</a>.</p>
<p>Within the PrinterExtensionLibrary project that is included with the PrinterExtension sample project, there are two C# files. These files wrap the contents of PrinterExtensionLib, but additional classes could be added at this layer in order to enable code
 sharing between printer extensions and Windows Store device apps.</p>
<ul>
<li>
<p>PrinterExtensionTypes.cs specifies a number of helpful enumerations, constants and interfaces that wrap the COM PrinterExtensionLib APIs.</p>
</li><li>
<p>PrinterExtensionAdapters.cs specifies all of the constructable classes used to wrap the COM PrinterExtensionLib APIs.</p>
</li></ul>
<p>This project may be augmented with any necessary C# files that describe common model layer code necessary to build your printer extension and/or Windows Store device app for printers. Microsoft recommends against updating the existing classes insofar as
 possible, as this will make it more difficult for manufacturers to incorporate bug fixes to the app samples as they become available.</p>
<p><b>Device App for Printers Helper Library</b></p>
<p>In order to convert the C# interfaces, classes and methods to something supported in JavaScript, this project will create a WinMD file. WinMD files specify Windows Runtime APIs. Additionally, this library can be used to expose convenience objects that are
 specific to the Windows Store device app for printers, such as parsing out different activation contexts.
</p>
<ul>
<li>
<p>PrintHelperClass.cs includes the PrinterExtensionLibrary namespaces in order to expose them to JavaScript layers in the app. It also includes some convenience methods for PrintTicket and Bidi.</p>
</li></ul>
<h2><a id="related_topics"></a>Related topics</h2>
<dl><dt><a href="http://go.microsoft.com/fwlink/p/?LinkID=301381">Windows Store device apps</a>
</dt><dt><a href="http://go.microsoft.com/fwlink/p/?LinkID=299829">Print job management and device maintenance (device app for printer sample)</a>
</dt><dt><a href="http://go.microsoft.com/fwlink/p/?LinkID=227694">Windows 8 app samples</a>
</dt></dl>
<h2>Operating system requirements</h2>
<table>
<tbody>
<tr>
<th>Client</th>
<td><dt>Windows&nbsp;8.1 </dt></td>
</tr>
<tr>
<th>Server</th>
<td><dt>Windows Server&nbsp;2012&nbsp;R2 </dt></td>
</tr>
</tbody>
</table>
<h2>Build the sample</h2>
<h2><a id="Prerequisites"></a><a id="prerequisites"></a><a id="PREREQUISITES"></a>Prerequisites</h2>
<p>The Windows Store device app that this sample demonstrates must be linked to your printer using device metadata.</p>
<ul>
<li>
<p>You need a copy of the device metadata package for your printer, to add the device app info to it. If you donâ€™t have device metadata, you can build it using the
<b>Device Metadata Authoring Wizard</b> as described in the topic <a href="http://go.microsoft.com/fwlink/p/?LinkId=313644">
Step 2: Create device metadata for your Windows Store device app</a>.</p>
<p class="note"><b>Note</b>&nbsp;&nbsp;To use the <b>Device Metadata Authoring Wizard</b>, you must install Microsoft Visual Studio Professional&nbsp;2013, Microsoft Visual Studio Ultimate&nbsp;2013, or the
<a href="http://go.microsoft.com/fwlink/?LinkID=309209">standalone SDK for Windows&nbsp;8.1</a> before completing the steps in this topic. Installing Microsoft Visual Studio Express&nbsp;2013 for Windows installs a version of the SDK that doesn't include the wizard.</p>
</li></ul>
<h2><a id="Install_the_sample"></a><a id="install_the_sample"></a><a id="INSTALL_THE_SAMPLE"></a>Install the sample</h2>
<p>The following steps build the sample and install device metadata.</p>
<ol>
<li>Enable test signing.
<ol>
<li>Start the <b>Device Metadata Authoring Wizard</b> from <i>%ProgramFiles(x86)%</i>\Windows Kits\8.1\bin\x86, by double-clicking
<b>DeviceMetadataWizard.exe</b> </li><li>From the <b>Tools</b> menu, select <b>Enable Test Signing</b>. </li></ol>
</li><li>Reboot the computer </li><li>
<p>Build the solution by opening the solution (.sln) file. Press F7 or go to <b>Build-&gt;Build Solution</b> from the top menu after the sample has loaded.
</p>
</li><li>Disconnect and uninstall the printer. This step is required so that Windows will read the updated device metadata the next time the device is detected.
</li><li>Edit and save device metadata. To link the device app to your device, you must associate the device app with your device.
<p class="note"><b>Note</b>&nbsp;&nbsp;If you haven't created your device metadata yet, see
<a href="http://go.microsoft.com/fwlink/p/?LinkId=313644">Step 2: Create device metadata for your Windows Store device app</a>.</p>
<ol>
<li>If the <b>Device Metadata Authoring Wizard</b> is not open yet, start it from
<i>%ProgramFiles(x86)%</i>\Windows Kits\8.1\bin\x86, by double-clicking <b>DeviceMetadataWizard.exe</b>.
</li><li>Click <b>Edit Device Metadata</b>. This will let you edit your existing device metadata package.
</li><li>In the <b>Open</b> dialog box, locate the device metadata package associated with your Windows Store device app. (It has a
<b>devicemetadata-ms</b> file extension.) </li><li>On the <b>Specify Windows Store device app information</b> page, enter the Windows Store app info in the
<b>Windows Store device app</b> box. Click on <b>Import Windows Store App manifest file</b> to automatically enter the
<b>Package name</b>, <b>Publisher name</b>, and <b>Windows Store App ID</b>. </li><li>
<p>If your app is registering for printer notifications, fill out the <b>Notification handlers</b> box. In
<b>Event ID</b>, enter the name of the print event handler. In <b>Event Asset</b>, enter the name of the file where that code resides.</p>
</li><li>When you're done, click <b>Next</b> until you get to the <b>Finish</b> page. </li><li>On the <b>Review the device metadata package</b> page, make sure that all of the settings are correct and select the
<b>Copy the device metadata package to the metadata store on the local computer</b> check box. Then click
<b>Save</b>. </li></ol>
</li><li>Reconnect your printer so that Windows reads the updated device metadata when the device is connected.
</li></ol>
<h2>Run the sample</h2>
<p>To debug the app and then run it, press F5 or use <b>Debug</b> &gt; <b>Start Debugging</b>. To run the app without debugging, press Ctrl&#43;F5 or use
<b>Debug</b> &gt; <b>Start Without Debugging</b>. </p>
</div>

</div>


    </div>
</body>
</html>
