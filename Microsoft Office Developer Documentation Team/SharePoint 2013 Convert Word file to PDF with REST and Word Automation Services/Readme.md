# SharePoint 2013: Convert Word file to PDF with REST and Word Automation Services
## Requires
- 
## License
- Apache License, Version 2.0
## Technologies
- Javascript
- SharePoint Server 2013
- SharePoint Foundation 2013
- apps for SharePoint
## Topics
- data and storage
## Updated
- 07/31/2013
## Description

<div id="header">
<table id="bottomTable" cellspacing="0" cellpadding="0">
<tbody>
<tr id="headerTableRow1">
<td align="left"><span id="runningHeaderText">&nbsp;</span></td>
</tr>
<tr id="headerTableRow2">
<td align="left"><span id="nsrTitle">SharePoint 2013: Convert Word file to PDF with REST and Word Automation Services</span></td>
</tr>
</tbody>
</table>
</div>
<div id="mainSection">
<div id="mainBody">
<div>
<p>Demonstrates how to use Word Automation Services in an app for SharePoint.</p>
</div>
<div>
<p><span>Provided by:</span> <a href="http://mvp.microsoft.com/en-us/mvp/Scot%20Hillier-33471" target="_blank">
Scot Hillier</a>, <a href="http://www.criticalpathtraining.com/Pages/default.aspx" target="_blank">
Critical Path Training</a></p>
<p>Using Word Automation Services can be challenging because it does not support client object model (CSOM) or RESTful access. This sample demonstrates creating a custom RESTful service app that wraps the Word Automation Services functionality.</p>
<p>There are two parts to this sample: an action app (in <strong><span class="keyword">App.sln</span></strong>) that provides a custom editing action, and a service app (in
<strong><span class="keyword">Service.sln</span></strong>) that translates an incoming request from the action app into Word Automation Services calls.</p>
<p>This sample app lets a user select a Word document (<strong><span class="keyword">.docx</span></strong> format) from a document library for conversion to PDF format. The selection is done through a custom action that appears on the edit control block (ECB)
 for the list item. The ECB action is created through the action app. When the user initiates conversion, the action app receives the site URL, list identifier, and item identifier for the document. The action app then makes a call to the custom REST service
 app, which is configured as a Remote Endpoint. The custom REST service app then creates and starts the conversion job in Word Automation Services.</p>
</div>
<h1>Prerequisites</h1>
<div id="sectionSection0">
<p>This sample requires the following:</p>
<ul>
<li>
<p>A SharePoint 2013 development environment</p>
</li><li>
<p>Visual Studio 2012 and Office Developer Tools for Visual Studio 2012</p>
</li><li>
<p>Word Automation Services properly configured</p>
</li></ul>
</div>
<h1>Key components</h1>
<div id="sectionSection1">
<p>The sample consists of two apps for SharePoint in two Visual Studio 2012 solution files:</p>
<ul>
<li>
<p><strong><span class="keyword">App.sln</span> </strong>defines an app that contains a menu item custom action. This custom action app attaches to document library files and allows them to be selected for conversion.</p>
</li><li>
<p><strong><span class="keyword">Service.sln</span> </strong>defines a custom REST service app written using the MVC4 web API. This service app accepts the conversion request generated by the action app. The action app calls
<strong><span class="keyword">SP.RequestExecutor</span></strong>, which works with configured Remote Endpoints.</p>
</li></ul>
</div>
<h1>Configure the sample</h1>
<div id="sectionSection2">
<p>Follow these steps to configure the sample:</p>
<div>
<ol>
<li>
<p>Visual Studio must be configured to run Internet Information Services (IIS) Express in 64-bit mode so that the REST service can communicate with Word Automation Services. Set the following registry entry.</p>
<p><span>[HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\11.0\WebProjects]</span>
<br>
<span>&quot;Use64BitIISExpress&quot;=dword:00000001</span></p>
</li><li>
<p>SharePoint must be configured to allow Remote Endpoint intranet calls to local web services by using the following Windows PowerShell commands.</p>
<p><span>$f = Get-SPFarm</span> <br>
<span>$f.Properties.DisableIntranetCalls = $false</span> <br>
<span>$f.Properties.DisableIntranetCallsFromApps = $false</span> <br>
<span>$f.Update()</span></p>
</li><li>
<p>Set permissions in the Word Automation Services service application for a given set of users to access Word Automation Services functionality. Select the Word Automation Services service application in the list of service applications, and click
<strong><span class="ui">Permissions</span></strong>.</p>
</li></ol>
</div>
</div>
<h1>Build, run, and test the sample</h1>
<div id="sectionSection3">
<p>The sample consists of two separate solutions that should be run in two instances of Visual Studio. One solution is called &quot;Service&quot; and the other is called &quot;App&quot;.</p>
<div>
<ol>
<li>
<p>Open the <strong><span class="keyword">Service.sln</span></strong> solution in Visual Studio 2012.</p>
</li><li>
<p>Press F5.</p>
</li><li>
<p>Open the <strong><span class="keyword">App.sln</span></strong> solution in Visual Studio 2012.</p>
</li><li>
<p>Edit the deployment URL to point to a site in your development environment.</p>
</li><li>
<p>Press F5.</p>
</li><li>
<p>When the app appears, navigate to a document library in the host web that contains .docx files.</p>
</li><li>
<p>Using the edit control block, select a .docx file for conversion.</p>
</li><li>
<p>The app notifies you when the conversion job starts, and it provides links to the source and destination documents.</p>
</li></ol>
</div>
</div>
<h1>Troubleshooting</h1>
<div id="sectionSection4">
<p>Follow the configuration steps carefully. Any problems with the sample will probably come from permission issues.</p>
</div>
<h1>Change log</h1>
<div id="sectionSection5"><strong>
<div class="caption"></div>
</strong>
<div>
<table cellspacing="2" cellpadding="5" width="50%" frame="lhs">
<tbody>
<tr>
<th>
<p>Version</p>
</th>
<th>
<p>Date</p>
</th>
</tr>
<tr>
<td>
<p>First version</p>
</td>
<td>
<p>July 2013</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<h1>Related content</h1>
<div id="sectionSection6">
<ul>
<li>
<p><a href="http://msdn.microsoft.com/en-us/library/fp179887.aspx#Self_hosted" target="_blank">SharePoint 2013 provider-hosted apps</a></p>
</li><li>
<p><a href="http://msdn.microsoft.com/en-us/library/jj163073.aspx" target="_blank">Word Automation Services</a></p>
</li><li>
<p><a href="http://www.asp.net/mvc/mvc4" target="_blank">ASP.NET MVC4</a></p>
</li></ul>
</div>
</div>
</div>
