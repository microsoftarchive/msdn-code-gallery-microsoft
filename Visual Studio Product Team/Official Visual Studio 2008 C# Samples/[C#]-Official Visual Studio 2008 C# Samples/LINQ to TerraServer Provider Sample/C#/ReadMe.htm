<!--To view a formatted version of this file, switch to Design view by clicking the Design tab at the bottom of the HTML Designer window.-->

<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="ReadMe_files/filelist.xml">
<title>LINQ to TerraServer Provider Sample</title>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="country-region"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="place"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="City"/>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:View>Normal</w:View>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--span.CODEEMBEDDED
	{position:relative;
	top:0pt;}

 /* Font Definitions */
 @font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:1627421319 -2147483648 8 0 66047 0;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 0 0 0 415 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1610611985 1073750139 0 0 159 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:Calibri;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{font-family:"Times New Roman";
	mso-ascii-font-family:"Times New Roman";
	mso-hansi-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{font-family:"Times New Roman";
	mso-ascii-font-family:"Times New Roman";
	mso-hansi-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:purple;
	text-decoration:underline;
	text-underline:single;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:8.0pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-locked:yes;
	mso-style-link:"Balloon Text";
	font-family:Tahoma;
	mso-ascii-font-family:Tahoma;
	mso-hansi-font-family:Tahoma;
	mso-bidi-font-family:Tahoma;}
p.Normal1, li.Normal1, div.Normal1
	{mso-style-name:"Normal1\,Text\,t";
	margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	line-height:13.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Verdana;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.Heading11, li.Heading11, div.Heading11
	{mso-style-name:"Heading 11\,h1";
	margin-top:9.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:-.25in;
	line-height:18.0pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:Verdana;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;
	font-weight:bold;}
p.Heading21, li.Heading21, div.Heading21
	{mso-style-name:"Heading 21\,h2";
	margin-top:9.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:-.25in;
	line-height:16.0pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:Verdana;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:gray;
	font-weight:bold;}
p.Heading31, li.Heading31, div.Heading31
	{mso-style-name:"Heading 31\,h3";
	margin-top:9.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:-.25in;
	line-height:16.0pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:Verdana;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:silver;
	font-weight:bold;}
p.NumberedList1, li.NumberedList1, div.NumberedList1
	{mso-style-name:"Numbered List 1\,nl1";
	margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.25in;
	text-indent:-.25in;
	line-height:13.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Verdana;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;}
p.TableSpacing, li.TableSpacing, div.TableSpacing
	{mso-style-name:"Table Spacing\,ts";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:0in;
	line-height:6.0pt;
	mso-pagination:widow-orphan;
	font-size:6.0pt;
	font-family:Verdana;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:silver;}
p.BulletedList1, li.BulletedList1, div.BulletedList1
	{mso-style-name:"Bulleted List 1\,bl1";
	margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.25in;
	text-indent:-.25in;
	line-height:13.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Verdana;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;}
p.BulletedList2, li.BulletedList2, div.BulletedList2
	{mso-style-name:"Bulleted List 2\,bl2";
	margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.5in;
	text-indent:-.25in;
	line-height:13.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Verdana;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:black;}
p.msochpdefault, li.msochpdefault, div.msochpdefault
	{mso-style-name:msochpdefault;
	mso-margin-top-alt:auto;
	margin-right:0in;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
span.CodeEmbedded
	{mso-style-name:"Code Embedded\,ce";
	font-family:"Courier New";
	mso-ascii-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	color:navy;}
span.Italic
	{mso-style-name:"Italic\,i";
	font-family:"Times New Roman";
	mso-ascii-font-family:"Times New Roman";
	mso-hansi-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:fuchsia;
	font-style:italic;}
span.UI
	{mso-style-name:"UI\,ui";
	font-family:"Times New Roman";
	mso-ascii-font-family:"Times New Roman";
	mso-hansi-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:gray;
	font-weight:bold;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<p class=Heading11 style='margin-left:0in'>LINQ to TerraServer Provider Sample</p>

<p class=Normal1>This sample is a custom LINQ provider for the TerraServer-USA
Web service. It also contains a sample client application that uses the custom
LINQ provider to query the Web service for geographical data.</p>

<p class=Normal1>The TerraServer-USA Web service exposes a method that returns
information about locations in the <st1:place w:st="on"><st1:country-region
 w:st="on">United States</st1:country-region></st1:place> when the method is given
part or all of a location name. This method, which is named <span class=SpellE><span
class=CodeEmbedded>GetPlaceList</span></span>, is the method that the LINQ
provider calls to obtain the data that the LINQ query is run against. The
provider uses Windows Communication Foundation (WCF) to communicate with the
Web service. For more information about the TerraServer-USA Web service, see <span
lang=DE style='mso-ansi-language:DE'><a
href="http://terraserver.microsoft.com/webservices.aspx"><span lang=EN-US
style='font-family:"Times New Roman";mso-ansi-language:EN-US'>Overview of the
TerraServer-USA Web Services</span></a></span>.</p>

<p class=Normal1>A LINQ provider that implements the <span class=SpellE><b>System.Linq.IQueryable</b></span><b>&lt;T&gt;</b>
interface, such as this one, enables LINQ queries to be written against the
data source that the provider connects to. A provider may execute the query
functionality on the data itself, or it may translate the LINQ query into a
query language that is appropriate for the data source that it connects to.
This provider obtains raw data from the Web service and then modifies the
original query in such a way that LINQ to Objects handles the query execution.</p>

<p class=Normal1><b style='mso-bidi-font-weight:normal'>Security Note</b>:</p>

<p class=Normal1>This sample code is intended to illustrate a concept, and it
shows only the code that is relevant to that concept. It may not meet the
security requirements for a specific environment, and it should not be used
exactly as shown. We recommend that you add security and error-handling code to
make your projects more secure and robust. Microsoft provides this sample code
&quot;AS IS&quot; with no warranties.</p>

<p class=Heading21 style='margin-left:0in'>Requirements</p>

<p class=Normal1>You need the following components to run this sample:</p>

<p class=BulletedList1><span style='font-family:Symbol'>·</span><span
style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Visual Studio 2008</p>

<p class=Heading21 style='margin-left:0in'>To run the client application in
Visual Studio</p>

<p class=NumberedList1>1.<span style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Open the file <span class=SpellE>LinqToTerraServerProvider.sln</span>
with Visual Studio.</p>

<p class=NumberedList1>2.<span style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Press <b style='mso-bidi-font-weight:normal'><span style='color:gray'>F5</span></b>
to run the application.</p>

<p class=Heading21 style='margin-left:0in'>File Descriptions</p>

<p class=Normal1>The following table lists the files in the <span class=SpellE><b>LinqToTerraServerProvider</b></span>
project.</p>

<p class=TableSpacing><a name="ddue_InsertableRange">&nbsp;</a></p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=609
 style='width:456.8pt;border-collapse:collapse;mso-padding-alt:0in 0in 0in 0in'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=224 valign=top style='width:167.75pt;border:solid silver 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>File</span></p>
  </td>
  <td width=385 valign=top style='width:289.05pt;border:solid silver 1.0pt;
  border-left:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>Description</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=224 valign=top style='width:167.75pt;border:solid silver 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>Evaluator.cs</span></p>
  </td>
  <td width=385 valign=top style='width:289.05pt;border-top:none;border-left:
  none;border-bottom:solid silver 1.0pt;border-right:solid silver 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1>Partially evaluates the query's expression tree. This
  translates all local variable references in the LINQ query into values.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2'>
  <td width=224 valign=top style='width:167.75pt;border:solid silver 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>ExpressionTreeHelpers.cs</span></p>
  </td>
  <td width=385 valign=top style='width:289.05pt;border-top:none;border-left:
  none;border-bottom:solid silver 1.0pt;border-right:solid silver 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1>Contains methods that can be used to determine information about
  and extract data from specific types of expression trees.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:3'>
  <td width=224 valign=top style='width:167.75pt;border:solid silver 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>ExpressionTreeModifier.cs</span></p>
  </td>
  <td width=385 valign=top style='width:289.05pt;border-top:none;border-left:
  none;border-bottom:solid silver 1.0pt;border-right:solid silver 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1>An expression tree visitor subclass that modifies the
  expression tree that represents the complete LINQ query.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:4'>
  <td width=224 valign=top style='width:167.75pt;border:solid silver 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>ExpressionVisitor.cs</span></p>
  </td>
  <td width=385 valign=top style='width:289.05pt;border-top:none;border-left:
  none;border-bottom:solid silver 1.0pt;border-right:solid silver 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1>The base expression tree visitor class.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:5'>
  <td width=224 valign=top style='width:167.75pt;border:solid silver 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>InnermostWhereFinder.cs</span></p>
  </td>
  <td width=385 valign=top style='width:289.05pt;border-top:none;border-left:
  none;border-bottom:solid silver 1.0pt;border-right:solid silver 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1>An expression tree visitor subclass that finds the
  expression in the query's expression tree that represents the innermost call
  to the <span class=SpellE><b>System.Linq.Queryable.Where</b></span> method.
  This innermost expression is the expression that the provider extracts the
  search locations from.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:6'>
  <td width=224 valign=top style='width:167.75pt;border:solid silver 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>InvalidQueryException.cs</span></p>
  </td>
  <td width=385 valign=top style='width:289.05pt;border-top:none;border-left:
  none;border-bottom:solid silver 1.0pt;border-right:solid silver 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1>Defines an exception that is thrown when an invalid query is
  submitted.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:7'>
  <td width=224 valign=top style='width:167.75pt;border:solid silver 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>LocationFinder.cs</span></p>
  </td>
  <td width=385 valign=top style='width:289.05pt;border-top:none;border-left:
  none;border-bottom:solid silver 1.0pt;border-right:solid silver 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1>An expression tree visitor subclass that extracts location information
  from the LINQ query to use in the Web service request. This class understands
  location information that is provided in one of the following forms:</p>
  <p class=BulletedList2><span style='font-family:Symbol'>·</span><span
  style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>An equality expression, for example <span class=SpellE><span
  class=CodeEmbedded>place.Name</span></span><span class=CodeEmbedded> ==
  &quot;<st1:City w:st="on"><st1:place w:st="on">Seattle</st1:place></st1:City>&quot;</span>.</p>
  <p class=BulletedList2><span style='font-family:Symbol'>·</span><span
  style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>A method call expression for the method <span class=SpellE><b>System.String.StartsWith</b></span>,
  for example <span class=SpellE><span class=CodeEmbedded>place.Name.StartsWith</span></span><span
  class=CodeEmbedded>(&quot;Seat&quot;)</span>.</p>
  <p class=BulletedList2><span style='font-family:Symbol'>·</span><span
  style='font-size:7.0pt;font-family:"Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>A method call expression for the method <span class=SpellE><b>System.Linq.Enumerable.Contains</b></span><b>&lt;T&gt;</b>
  or <span class=SpellE><b>System.Collections.Generic.List</b></span><b>&lt;T&gt;.Contains</b>,
  for example <span class=SpellE><span class=CodeEmbedded>placeList.Contains</span></span><span
  class=CodeEmbedded>(<span class=SpellE>place.Name</span>)</span>.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:8'>
  <td width=224 valign=top style='width:167.75pt;border:solid silver 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>Place.cs</span></p>
  </td>
  <td width=385 valign=top style='width:289.05pt;border-top:none;border-left:
  none;border-bottom:solid silver 1.0pt;border-right:solid silver 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1>Defines a custom .NET type to represent the data from the
  Web service.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:9'>
  <td width=224 valign=top style='width:167.75pt;border:solid silver 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>QueryableTerraServerData.cs</span></p>
  </td>
  <td width=385 valign=top style='width:289.05pt;border-top:none;border-left:
  none;border-bottom:solid silver 1.0pt;border-right:solid silver 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1>Contains the type the client query defines queries against.
  This type implements <span class=SpellE><b><span style='color:black'>System.Linq.IOrderedQueryable</span></b></span><b><span
  style='color:black'>&lt;T&gt;</span></b> to support sort operations in the
  query. Because <span class=SpellE><b><span style='color:black'>System.Linq.IOrderedQueryable</span></b></span><b><span
  style='color:black'>&lt;T&gt;</span></b> derives from <span class=SpellE><b><span
  style='color:black'>System.Linq.IQueryable</span></b></span><b><span
  style='color:black'>&lt;T&gt;</span></b>, by implementing <span class=SpellE><b><span
  style='color:black'>System.Linq.IOrderedQueryable</span></b></span><b><span
  style='color:black'>&lt;T&gt;</span></b> this type also implements <span
  class=SpellE><b><span style='color:black'>System.Linq.IQueryable</span></b></span><b><span
  style='color:black'>&lt;T&gt;</span></b>.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:10'>
  <td width=224 valign=top style='width:167.75pt;border:solid silver 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>TerraServerQueryContext.cs</span></p>
  </td>
  <td width=385 valign=top style='width:289.05pt;border-top:none;border-left:
  none;border-bottom:solid silver 1.0pt;border-right:solid silver 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1>Contains a class that organizes the work of executing a
  query.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:11'>
  <td width=224 valign=top style='width:167.75pt;border:solid silver 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>TerraServerQueryProvider.cs</span></p>
  </td>
  <td width=385 valign=top style='width:289.05pt;border-top:none;border-left:
  none;border-bottom:solid silver 1.0pt;border-right:solid silver 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1>Contains the type that implements the <span class=SpellE><b><span
  style='color:black'>System.Linq.IQueryProvider</span></b></span> interface.
  The methods that this interface defines are called by the standard query
  operator methods that are defined in <span class=SpellE><b><span
  style='color:black'>System.Linq.Queryable</span></b></span>, to execute the
  query.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:12'>
  <td width=224 valign=top style='width:167.75pt;border:solid silver 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>TypeSystem.cs</span></p>
  </td>
  <td width=385 valign=top style='width:289.05pt;border-top:none;border-left:
  none;border-bottom:solid silver 1.0pt;border-right:solid silver 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1>This helper class implements a method that is used to supply
  the element type of the generic collection that contains the query results.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:13;mso-yfti-lastrow:yes'>
  <td width=224 valign=top style='width:167.75pt;border:solid silver 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>WebServiceHelper.cs</span></p>
  </td>
  <td width=385 valign=top style='width:289.05pt;border-top:none;border-left:
  none;border-bottom:solid silver 1.0pt;border-right:solid silver 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1>Obtains data from the Web service. This code contains two
  checks that enhance the usability of the provider library. The first check
  limits the maximum time that a client application will wait for a response by
  limiting the total number of calls that are made to the Web service, per
  query, to five. The second check determines whether the number of results
  returned by the Web service is equal to the maximum number of results that it
  can return. If the number of results is the maximum number, it is likely that
  the results from the Web service are truncated. Instead of returning an
  incomplete list to the client, the provider throws an exception.</p>
  </td>
 </tr>
</table>

<p class=TableSpacing>&nbsp;</p>

<p class=Normal1>The following table lists the files in the <span class=SpellE><b>ClientApp</b></span>
project.</p>

<p class=TableSpacing>&nbsp;</p>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=609
 style='width:456.8pt;border-collapse:collapse;mso-padding-alt:0in 0in 0in 0in'>
 <tr style='mso-yfti-irow:0;mso-yfti-firstrow:yes'>
  <td width=92 valign=top style='width:68.75pt;border:solid silver 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>File</span></p>
  </td>
  <td width=517 valign=top style='width:388.05pt;border:solid silver 1.0pt;
  border-left:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>Description</span></p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:1'>
  <td width=92 valign=top style='width:68.75pt;border:solid silver 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>Program.cs</span></p>
  </td>
  <td width=517 valign=top style='width:388.05pt;border-top:none;border-left:
  none;border-bottom:solid silver 1.0pt;border-right:solid silver 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1>Contains three example LINQ queries that query the <span
  class=SpellE><span class=CodeEmbedded>QueryableTerraServerData</span></span>
  type defined in the <span class=SpellE>LinqToTerraServerProvider</span>
  project.</p>
  </td>
 </tr>
 <tr style='mso-yfti-irow:2;mso-yfti-lastrow:yes'>
  <td width=92 valign=top style='width:68.75pt;border:solid silver 1.0pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1><span lang=DE style='mso-ansi-language:DE'>app.config</span></p>
  </td>
  <td width=517 valign=top style='width:388.05pt;border-top:none;border-left:
  none;border-bottom:solid silver 1.0pt;border-right:solid silver 1.0pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=Normal1>Contains an endpoint that defines how the application should
  communicate with the Web service.</p>
  </td>
 </tr>
</table>

<p class=TableSpacing>&nbsp;</p>

<p class=Normal1>For a more detailed discussion of the design of this custom
LINQ provider, see the topic titled <span class=Italic><span style='font-family:
Verdana;color:windowtext'>Walkthrough: Creating an <span class=SpellE>IQueryable</span>
LINQ Provider</span></span> in the <span lang=DE style='mso-ansi-language:DE'><a
href="http://msdn2.microsoft.com/en-us/library/default.aspx"><span lang=EN-US
style='mso-ascii-font-family:Verdana;mso-hansi-font-family:Verdana;mso-ansi-language:
EN-US'>MSDN Library</span></a></span>.</p>

<p class=MsoNormal>&nbsp;</p>

</div>

</body>

</html>
